CREATE TABLE VENDA (
	COD_VENDA SERIAL PRIMARY KEY,
	NOME_VENDEDOR VARCHAR(30) DEFAULT NULL,
	DATA_VENDA DATE DEFAULT NULL,
	VALOR_VENDIDO FLOAT DEFAULT NULL
);

-- VENDEDORES: MARIA, JOAO, SAMMYA, ENZO
-- MARIA: 1200,00
-- JOAO: 1050,00
-- SAMMYA: 980,00
-- ENZO: 950,00

-- 1) Povoe a tabela com 10 vendas, considerando que existam apenas 4
-- vendedores na loja.
INSERT INTO VENDA (NOME_VENDEDOR, DATA_VENDA, VALOR_VENDIDO) VALUES
('MARIA', '2025-01-02', 300.00),
('JOAO', '2025-01-03', 450.00),
('SAMMYA', '2025-01-04', 700.00),
('ENZO', '2025-01-05', 250.00),
('MARIA', '2025-01-10', 600.00),
('JOAO', '2025-01-11', 100.00),
('SAMMYA', '2025-01-24', 280.00),
('ENZO', '2025-01-25', 700.00),
('MARIA', '2025-02-10', 300.00),
('JOAO', '2025-02-11', 500.00);

-- 2.1) Mostre o nome dos vendedores que venderam mais de X reais no mês de março de 2024.
SELECT NOME_VENDEDOR, SUM(VALOR_VENDIDO) TOTAL FROM VENDA WHERE DATA_VENDA BETWEEN '2024-03-01' AND 
'2024-03-31' GROUP BY NOME_VENDEDOR HAVING SUM(VALOR_VENDIDO) > 200.00;

SELECT NOME_VENDEDOR, SUM(VALOR_VENDIDO) TOTAL FROM VENDA WHERE DATA_VENDA BETWEEN '2024-03-01' AND 
'2024-03-31'
-- EXTRACT(YEAR FROM DATA_VENDA) = 2024 AND EXTRACT(MONTH FROM DATA_VENDA) = 3 
GROUP BY NOME_VENDEDOR HAVING SUM(VALOR_VENDIDO) > 200.00 ORDER 
BY TOTAL DESC;

CREATE OR REPLACE VIEW VENDAS_MARCO AS SELECT NOME_VENDEDOR, SUM(VALOR_VENDIDO) TOTAL FROM VENDA WHERE 
DATA_VENDA BETWEEN '2024-03-01' AND '2024-03-31' GROUP BY NOME_VENDEDOR HAVING 
SUM(VALOR_VENDIDO) > 200.00;

SELECT * FROM VENDAS_MARCO;

-- 2.2) Mostre o nome de um dos vendedores que mais vendeu no mês de março de 2024
SELECT NOME_VENDEDOR, SUM(VALOR_VENDIDO) TOTAL FROM VENDA WHERE DATA_VENDA BETWEEN '2024-03-01' AND 
'2024-03-31' GROUP BY NOME_VENDEDOR ORDER BY SUM(VALOR_VENDIDO) DESC LIMIT 1;

CREATE OR REPLACE VIEW VENDEDOR_MAIS_VENDEU_MARCO_2024 AS SELECT NOME_VENDEDOR, SUM(VALOR_VENDIDO) TOTAL 
FROM VENDA WHERE DATA_VENDA BETWEEN '2024-03-01' AND '2024-03-31' GROUP BY NOME_VENDEDOR ORDER BY 
SUM(VALOR_VENDIDO) DESC LIMIT 1;

SELECT * FROM VENDEDOR_MAIS_VENDEU_MARCO_2024;

-- 3) Sem usar “select na cláusula from,” qual o nome do(s) vendedor(es) que mais vendeu no mês 
-- de março de 2024?

